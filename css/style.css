:root {
  /* Blue/Cyan Theme (Future Blue) */
  --bg: #0f172a;
  /* Slate 900 */
  --panel: rgba(30, 41, 59, 0.95);
  /* Slate 800 */
  --text: #f8fafc;
  /* Slate 50 */
  --muted: #94a3b8;
  /* Slate 400 */
  --gold: #06b6d4;
  /* Cyan 500 - Main Accent */
  --amber: #38bdf8;
  /* Sky 400 - Secondary */
  --red: #ef4444;
  /* Red 500 */
  --crimson: #b91c1c;
  /* Red 700 */
  --green: #22c55e;
  /* Green 500 */
  --primary: var(--gold);
  --accent: var(--crimson);
  --border: rgba(6, 182, 212, 0.3);
  --shadow: 0 0 15px rgba(6, 182, 212, 0.25), 0 0 25px rgba(56, 189, 248, 0.2);
  --font-stack: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;

  /* Neon Glows */
  --neon-main: var(--gold);
  --neon-alt: var(--red);
}

body {
  background: repeating-linear-gradient(45deg, #0b1120, #0b1120 10px, #0f172a 10px, #0f172a 20px);
  background-attachment: fixed;
  margin: 0;
  padding: 12px;
  color: var(--text);
  font-family: var(--font-stack);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  gap: 18px;
  overflow-x: hidden;
}

/* Scrollbar Hiding */
html {
  scrollbar-width: none;
  scroll-behavior: smooth;
}

body::-webkit-scrollbar {
  display: none;
}

/* --- Index Page Styles --- */
canvas#bgCanvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  background: var(--bg);
}

.wrap {
  max-width: 1200px;
  margin: auto;
  padding: 20px;
  position: relative;
  z-index: 1;
  width: 100%;
}

header.app {
  text-align: center;
  margin: 18px 0 14px;
}

header.app h1 {
  margin: 0;
  font-size: clamp(1.5rem, 4vw, 2.5rem);
  color: var(--neon-main);
  text-shadow: 0 0 10px rgba(6, 182, 212, 0.6), 0 0 20px rgba(56, 189, 248, 0.4);
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Grid for Menu */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.topic-card {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 24px 16px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: rgba(30, 41, 59, 0.85);
  /* Matches --panel */
  text-decoration: none;
  color: var(--text);
  box-shadow: var(--shadow);
  transition: all .2s ease-in-out;
  text-align: center;
  cursor: pointer;
  backdrop-filter: blur(5px);
}

.topic-card:hover:not(.disabled) {
  transform: translateY(-5px) scale(1.02);
  border-color: var(--neon-main);
  box-shadow: 0 0 15px var(--neon-main), 0 0 30px rgba(6, 182, 212, 0.3);
  background: rgba(30, 41, 59, 0.95);
}

.topic-card .kicker {
  font-size: .85rem;
  font-weight: 700;
  color: var(--neon-main);
  margin-bottom: 8px;
  letter-spacing: 1px;
  text-transform: uppercase;
}

.topic-card strong {
  font-size: 1.1rem;
  font-weight: 600;
  letter-spacing: .5px;
  color: var(--text);
  margin-bottom: 8px;
  line-height: 1.4;
}

.topic-card .badge {
  margin-top: auto;
  font-size: .75rem;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(15, 23, 42, 0.5);
  color: var(--muted);
}

.topic-card.disabled {
  opacity: 0.5;
  cursor: not-allowed;
  border-color: rgba(255, 255, 255, 0.05);
  background: rgba(15, 23, 42, 0.5);
  box-shadow: none;
}

.topic-card.disabled:hover {
  transform: none;
  box-shadow: none;
}


/* --- Exam Page Layout --- */
aside#dashboard {
  order: 2;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 14px;
  box-shadow: var(--shadow);
  backdrop-filter: blur(8px);
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  scrollbar-width: none;
}

aside#dashboard::-webkit-scrollbar {
  display: none;
}

main {
  order: 1;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  width: 100%;
}

@media (min-width: 980px) {
  body {
    padding: 20px;
    height: 100vh;
    overflow: hidden;
    display: grid;
    grid-template-columns: 320px 1fr;
    /* Sidebar fixed width */
    gap: 24px;
  }

  /* Wrap only applies to index, but if body is grid, index needs full width. 
       We will handle index specific layout via specific classes or ensuring .wrap spans all.
       Actually, standard style.css applies grid to BODY. 
       Index page uses .wrap. 
       We can reset body display for index page, OR make .wrap span full.
       Reference style.css applies grid to body on min-width 980px.
       Reference index.html DOES NOT link style.css! It renders standalone. 
       BUT we are linking it now. So we must protect the Grid layout to apply only when #dashboard exists or add a class to body.
       
       FIX: Only apply grid if #dashboard is present? CSS can't detect without :has().
       Safest: Add class="exam-mode" to body of exam.html.
    */

  body.exam-mode {
    display: grid;
    grid-template-columns: 340px 1fr;
    gap: 24px;
  }

  aside#dashboard {
    order: initial;
    overflow-y: auto;
    height: 100%;
  }

  main {
    order: initial;
    height: 100%;
    overflow-y: auto;
    scrollbar-width: none;
    display: block;
    /* Allow normal flow inside main */
  }

  main::-webkit-scrollbar {
    display: none;
  }
}

/* Mobile Optimizations for Exam */
@media (max-width: 979px) {
  body.exam-mode {
    display: flex;
    flex-direction: column;
  }

  aside#dashboard {
    flex-direction: row;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-around;
    padding: 10px;
    gap: 10px;
  }

  .ring,
  .ring svg {
    width: 80px;
    height: 80px;
  }

  .ring circle {
    stroke-width: 8;
    r: 34;
  }

  .card {
    padding: 10px;
    margin: 0;
  }

  .stat-grid {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 6px;
  }

  .badge {
    font-size: 0.75rem;
    padding: 4px 8px;
  }

  .navigator {
    display: flex;
    overflow-x: auto;
    max-width: 90vw;
    padding-bottom: 5px;
  }

  button {
    padding: 12px 16px;
  }

  h1 {
    font-size: 1.3rem;
  }

  #question-text {
    font-size: 1.1rem;
  }
}

/* Components */
.card {
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px;
  background: rgba(15, 23, 42, 0.6);
}

.row {
  display: flex;
  gap: 10px;
  align-items: center;
  justify-content: space-between;
}

.muted {
  color: var(--muted);
  font-size: .9rem;
}

.ring {
  width: 120px;
  height: 120px;
  margin: 4px auto;
  position: relative;
}

.ring svg {
  transform: rotate(-90deg);
  width: 100%;
  height: 100%;
  display: block;
}

.ring .label {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  font-weight: 800;
  color: var(--gold);
  font-size: 1.5rem;
}

/* Buttons */
button {
  padding: 12px 18px;
  font-size: .95rem;
  font-weight: 700;
  border: none;
  border-radius: 8px;
  color: #0f172a;
  cursor: pointer;
  transition: transform .15s, box-shadow .2s;
  text-transform: uppercase;
  letter-spacing: 0.5px;

  /* Cyan Gradient */
  background: linear-gradient(135deg, var(--gold), #0ea5e9);
  box-shadow: 0 4px 0 rgba(8, 145, 178, 0.6), 0 6px 15px rgba(0, 0, 0, .4);
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 0 rgba(8, 145, 178, 0.6), 0 0 15px rgba(6, 182, 212, 0.5);
  color: #fff;
}

button:active {
  transform: translateY(0);
  box-shadow: none;
}

button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
  background: #334155 !important;
  color: #94a3b8;
  box-shadow: none !important;
}

.btn-blue {
  /* Primary Action */
  background: linear-gradient(135deg, var(--gold), #0284c7);
  color: white;
}

.btn-amber {
  /* Secondary Action -> Now Sky Blue */
  background: linear-gradient(135deg, #38bdf8, #0ea5e9);
  color: #0f172a;
}

.btn-red {
  background: linear-gradient(135deg, var(--red), var(--crimson));
  color: white;
  box-shadow: 0 4px 0 rgba(153, 27, 27, 0.6), 0 6px 15px rgba(0, 0, 0, .4);
}

.btn-notebook {
  background: linear-gradient(135deg, #8b5cf6, #7c3aed);
  /* Violet */
  color: white !important;
  width: 100%;
  box-shadow: 0 4px 0 rgba(91, 33, 182, 0.6), 0 6px 15px rgba(0, 0, 0, .4);
}

.btn-notebook:hover {
  box-shadow: 0 0 15px #a78bfa;
}

/* Quiz Container */
#quiz-app {
  width: 100%;
  max-width: 900px;
  margin: 0 auto;
}

#quiz-container {
  background: var(--panel);
  padding: 24px;
  border-radius: 16px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  backdrop-filter: blur(10px);
}

h1 {
  text-align: center;
  color: var(--gold);
  margin: 0 0 20px;
  font-weight: 900;
  text-transform: uppercase;
  font-size: 1.6rem;
  text-shadow: 0 0 10px rgba(6, 182, 212, 0.4);
}

#question-text {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 24px;
  color: var(--text);
  line-height: 1.5;
}

/* Options */
.option {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  border: 1px solid rgba(6, 182, 212, 0.3);
  border-radius: 10px;
  cursor: pointer;
  background: rgba(15, 23, 42, 0.6);
  transition: .2s;
  position: relative;
  margin-bottom: 12px;
  width: 100%;
  box-sizing: border-box;
}

.option:hover {
  background: rgba(6, 182, 212, 0.1);
  border-color: var(--gold);
  box-shadow: 0 0 12px rgba(6, 182, 212, 0.2);
  transform: translateX(4px);
}

.option.selected {
  border-color: var(--gold);
  background: rgba(6, 182, 212, 0.2);
}

.option input[type=radio] {
  accent-color: var(--gold);
  transform: scale(1.3);
}

.option.disabled {
  cursor: default;
  background: rgba(15, 23, 42, 0.4) !important;
  color: var(--muted) !important;
  border-color: rgba(255, 255, 255, 0.05) !important;
  box-shadow: none !important;
  transform: none !important;
}

/* Feedback */
.option.revealed-correct {
  border: 2px solid var(--green) !important;
  background: rgba(34, 197, 94, 0.15) !important;
  box-shadow: 0 0 10px rgba(34, 197, 94, 0.2) !important;
}

.option.revealed-correct::after {
  content: "✅ Correcta";
  position: absolute;
  right: 16px;
  color: var(--green);
  font-weight: 800;
  font-size: 0.9rem;
}

.option.revealed-wrong {
  border: 2px solid var(--red) !important;
  background: rgba(239, 68, 68, 0.15) !important;
}

.option.revealed-wrong::after {
  content: "❌ Tu respuesta";
  position: absolute;
  right: 16px;
  color: var(--red);
  font-weight: 800;
  font-size: 0.9rem;
}

#feedback-container {
  margin-top: 20px;
  padding: 16px;
  border-radius: 10px;
  font-weight: 600;
  border: 2px solid transparent;
  animation: fadeIn 0.4s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.feedback-correct {
  background: rgba(34, 197, 94, 0.1);
  border-color: var(--green);
  color: #4ade80;
  /* Brighter green for text */
}

.feedback-incorrect {
  background: rgba(239, 68, 68, 0.1);
  border-color: var(--red);
  color: #f87171;
  /* Brighter red for text */
}

.feedback-skipped {
  background: rgba(245, 158, 11, 0.1);
  border-color: var(--amber);
  /* Defaults to amber for skip warning */
  color: #fbbf24;
}

/* Final Score */
#score-container {
  text-align: center;
  font-size: 1.1rem;
  margin-top: 10px;
  padding: 20px;
  background: var(--panel);
  border-radius: 14px;
  border: 1px solid var(--gold);
  box-shadow: 0 0 30px rgba(6, 182, 212, 0.2);
}

.hidden {
  display: none !important;
}

/* Dashboard Badges */
.badge {
  border-radius: 8px;
  padding: 8px 10px;
  text-align: center;
  font-weight: 800;
  font-size: 0.85rem;
  border: 1px solid transparent;
}

.badge.ok {
  color: #4ade80;
  border-color: rgba(34, 197, 94, 0.3);
  background: rgba(34, 197, 94, 0.1);
}

.badge.ko {
  color: #f87171;
  border-color: rgba(239, 68, 68, 0.3);
  background: rgba(239, 68, 68, 0.1);
}

.badge.sk {
  color: #7dd3fc;
  border-color: rgba(56, 189, 248, 0.3);
  background: rgba(56, 189, 248, 0.1);
}

.badge.sc {
  color: var(--gold);
  border-color: rgba(6, 182, 212, 0.3);
  background: rgba(6, 182, 212, 0.1);
}

.stat-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}

.navigator {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(28px, 1fr));
  gap: 6px;
  margin-top: 12px;
}

.pill {
  padding: 6px 0;
  text-align: center;
  border-radius: 6px;
  background: rgba(255, 255, 255, 0.05);
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--muted);
  border: 1px solid transparent;
  cursor: pointer;
  transition: all 0.2s;
}

.pill:hover {
  border-color: var(--gold);
  color: #fff;
}

.pill.cur {
  border-color: var(--gold);
  color: #fff;
  box-shadow: 0 0 10px rgba(6, 182, 212, 0.4);
  background: rgba(6, 182, 212, 0.2);
}

.pill.ok {
  color: #22c55e;
  background: rgba(34, 197, 94, 0.15);
}

.pill.ko {
  color: #ef4444;
  background: rgba(239, 68, 68, 0.15);
}

.pill.sk {
  color: #38bdf8;
  background: rgba(56, 189, 248, 0.15);
}

/* Final Overlay */
#final-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.95);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  padding: 20px;
  backdrop-filter: blur(10px);
}

#final-card {
  background: var(--panel);
  border: 1px solid var(--gold);
  box-shadow: 0 0 50px rgba(6, 182, 212, 0.3);
  padding: 40px;
  border-radius: 20px;
  text-align: center;
  max-width: 500px;
  width: 100%;
}

/* Confetti */
.confetti {
  position: fixed;
  top: -10px;
  width: 8px;
  height: 14px;
  opacity: 0.9;
  z-index: 2001;
}

@keyframes fallConfetti {
  to {
    transform: translateY(110vh) rotate(360deg);
  }
}